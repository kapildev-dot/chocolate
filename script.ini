// ==================== CORE LOGIC ====================
const moodSection = document.getElementById("mood-section");
const contentArea = document.getElementById("content-area");
const futureMsgArea = document.getElementById("future-msg-area");
const promisesArea  = document.getElementById("promises-area");
const gameArea      = document.getElementById("game-area");

const futureMessages = [
  "Agar aaj bura din haiâ€¦ to yaad rakhna main hoon â¤ï¸",
  "Kal kuch bhi ho, tum akela nahi ho ğŸ«¶",
  "Raat ko yaad aana thoda zyada dangerous hota hai ğŸ¥°",
  "Bas ek baar bol denaâ€¦ main turant aa jaungi ğŸ¤—",
  "Tumhari wajah se meri playlist mein sirf love songs baj rahe hain ğŸ¶ğŸ’•"
];

let openedChocolates = 0;
let sharedCount = localStorage.getItem("chocoShareCount") || 0;
document.getElementById("count").textContent = sharedCount;

// ==================== MOOD SELECTION ====================
document.querySelectorAll(".mood").forEach(btn => {
  btn.addEventListener("click", () => {
    const mood = btn.dataset.mood;
    moodSection.classList.add("hidden");

    if (mood === "yes") {
      contentArea.innerHTML = `
        <div class="card">
          <h2>Yayyy! ğŸ¥°</h2>
          <p>Toh chaloâ€¦ 5 chocolates khol ke dekhte hain kitna pyaar hai mere dil mein ğŸ«</p>
          <div id="choco-list" class="choco-grid"></div>
          <p id="proposal" class="hidden" style="font-size:1.4rem; color:#e91e63; text-align:center; margin-top:30px;">
            Will you be mine? ğŸ’â¤ï¸
          </p>
        </div>
      `;
      initChocolates();
    } else if (mood === "maybe") {
      contentArea.innerHTML = `
        <div class="card">
          <h2>Thoda time lagegaâ€¦ it's okay ğŸ¥º</h2>
          <p>Main wait karungiâ€¦ jitna time lage utna hi pyaar badhega â¤ï¸</p>
        </div>
      `;
    } else if (mood === "no") {
      contentArea.innerHTML = `
        <div class="card">
          <h2>It's okayâ€¦ dil se dil tak baat pahunch gayi ğŸ«¶</h2>
          <p>Bas khush rehnaâ€¦ yahi meri dua hai ğŸŒ¸</p>
        </div>
      `;
    }

    contentArea.classList.remove("hidden");
    futureMsgArea.classList.remove("hidden");
  });
});

// ==================== VIRTUAL CHOCOLATES ====================
function initChocolates() {
  const list = document.getElementById("choco-list");
  const feelings = [
    "Tumhari smile pasand hai ğŸ¥°",
    "Tum jab baat karte hoâ€¦ dil sunta hai â¤ï¸",
    "Tumhare saath silence bhi achi lagti hai ğŸ¤«ğŸ’•",
    "Tum ho toh har din chocolate day lagta hai ğŸ«",
    "I thinkâ€¦ I really like youâ€¦ bahut zyada ğŸ˜³ğŸ’–"
  ];

  for(let i=1; i<=5; i++){
    const div = document.createElement("div");
    div.className = "choco-item";
    div.innerHTML = `<span>ğŸ« ${i}</span>`;
    div.onclick = () => {
      if (!div.classList.contains("opened")) {
        div.innerHTML = `<span>${feelings[i-1]}</span>`;
        div.classList.add("opened");
        openedChocolates++;
        if (openedChocolates === 5) {
          document.getElementById("proposal").classList.remove("hidden");
        }
      }
    };
    list.appendChild(div);
  }
}

// ==================== FUTURE MESSAGE ====================
document.getElementById("open-when-miss").onclick = () => {
  const msg = futureMessages[Math.floor(Math.random() * futureMessages.length)];
  document.getElementById("future-message").textContent = msg;
};

// ==================== PROMISES CHECKBOX ====================
const promises = document.querySelectorAll(".promise");
const seriousBtn = document.getElementById("serious-btn");

promises.forEach(chk => {
  chk.addEventListener("change", checkPromises);
});

function checkPromises() {
  const allChecked = [...promises].every(chk => chk.checked);
  seriousBtn.disabled = !allChecked;
  seriousBtn.classList.toggle("enabled", allChecked);
}

seriousBtn.onclick = () => {
  alert("Main bhi serious hoonâ€¦ promise ğŸ’â¤ï¸");
};

// ==================== MINI GAME - Catch Chocolates ====================
let score = 0;
document.getElementById("start-game").onclick = () => {
  const canvas = document.getElementById("game-canvas");
  canvas.innerHTML = "";
  score = 0;
  document.getElementById("game-result").textContent = "";

  for(let i=0; i<10; i++){
    setTimeout(() => {
      const choco = document.createElement("div");
      choco.className = "chocolate";
      choco.textContent = "ğŸ«";
      choco.style.left = Math.random()*90 + "%";
      choco.style.animation = `fall ${4 + Math.random()*3}s linear`;
      canvas.appendChild(choco);

      choco.onclick = () => {
        score++;
        choco.remove();
      };

      setTimeout(() => choco.remove(), 8000);
    }, i * 800);
  }

  setTimeout(() => {
    if(score >= 7){
      document.getElementById("game-result").innerHTML = "Shayad tum bhi utna hi care karte ho jitna main karti hoon ğŸ¥ºâ¤ï¸";
    } else {
      document.getElementById("game-result").innerHTML = "Koi baat nahiâ€¦ pyaar competition nahi hota ğŸ˜Œ";
    }
  }, 10000);
};

// ==================== SHARE LOGIC ====================
document.getElementById("share-btn").onclick = () => {
  sharedCount++;
  localStorage.setItem("chocoShareCount", sharedCount);
  document.getElementById("count").textContent = sharedCount;

  const text = "Main bol nahi paatiâ€¦ isliye ye page bhej rahi hoon ğŸ¥ºğŸ«\n" + window.location.href;
  navigator.clipboard.writeText(text).then(() => {
    alert("Link copy ho gaya! Share kar do ğŸ’•");
  });
};

// ==================== TIME BASED GREETING ====================
const hour = new Date().getHours();
if (hour >= 21 || hour < 5) {
  document.querySelector(".subtitle").textContent = "Raat me yaad aana thoda zyada dangerous hota hai â¤ï¸";
} else if (hour >= 5 && hour < 12) {
  document.querySelector(".subtitle").textContent = "Good morningâ€¦ aaj ka din sweet ho ğŸ«";
}

// Secret easter egg: type name 3 times (example: alert on triple click or something simple)
let clickCount = 0;
document.querySelector(".title").addEventListener("click", () => {
  clickCount++;
  if(clickCount >= 3){
    alert("Tumhe sach me samajhne wali ladki mil jaayeâ€¦ chahe wo main hi kyun na ho â¤ï¸");
    clickCount = 0;
  }
});